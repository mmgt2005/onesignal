<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Subscribe and Tag with OneSignal</title>
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
        window.OneSignalDeferred = window.OneSignalDeferred || [];
        const ONE_SIGNAL_APP_ID = "YOUR-ONESIGNAL-APP-ID"; // Replace with your actual app ID

        OneSignalDeferred.push(async function(OneSignal) {
            OneSignal.init({
                appId: ONE_SIGNAL_APP_ID,
                serviceWorkerPath: '/OneSignalSDKWorker.js',
                subdomainName: null,
                notifyButton: {
                    enable: false
                }
            });

            // Extract userId from URL parameter (?userId=123)
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get('userId');

            if (userId) {
                // Set external user ID
                await OneSignal.login(userId);
                console.log("User ID set:", userId);
            } else {
                console.log("No userId parameter provided in the URL.");
            }
        });
    </script>
</head>
<body>
    <h1>Subscribe to Notifications</h1>
    <button id="subscribe-btn">Subscribe</button>

    <script>
        document.getElementById('subscribe-btn').addEventListener('click', async () => {
            OneSignalDeferred.push(async function(OneSignal) {
                try {
                    await OneSignal.Slidedown.promptPush();
                    console.log("Subscription flow triggered.");
                } catch (error) {
                    console.error("Error triggering subscription:", error);
                }
            });
        });
    </script>
</body>
</html>
